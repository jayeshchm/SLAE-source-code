; SOURCE CODE TO GENERATE SHELLCODE FOR: ping localhost


global _start

section .text

	_start:
		
		xor eax , eax
		push eax			
		
		push 0x68732f2f			; /bin/sh
		push 0x6e69622f

		mov ebx , esp			; address of /bin/sh
		
		push eax			; ping localhost string
		push 0x74736f68
		push 0x6c61636f
		push 0x6c20676e
		push word 0x6970
		
		mov esi , esp			; address of ping localhost string

		push eax
		push word 0x632d		; -c string

		mov ecx , esp			; address of -c

		push eax			; NULL passed to top of the stack	
		push esi			; address of ping localhost passed to the stack
		push ecx			; address of -c passed to the stack
		push ebx			; address of command /bin/sh

		mov ecx , esp			; calling syscall
						; address of argv
		
		push eax			; NULL
		mov edx , esp			; address of envp

		mov al , 0xb			; syscall number

		int 0x80
